# Pentesting (kali)

- [Pentesting (kali)](#pentesting-kali)
  - [Installation](#installation)
  - [Security notes](#security-notes)
  - [Update and upgrade](#update-and-upgrade)
  - [New SSH keys](#new-ssh-keys)
  - [Firefox plugins](#firefox-plugins)

## Installation

Kali [installation per netinstaller iso](https://www.kali.org/downloads/) in [KVM](Installation-kvm.md) went without a glitch.

## Security notes

When installing kali in a virtual machine from a premade image, there are several components that are not installed, outdated or set with insecure default settings like [default credentials](https://www.kali.org/docs/introduction/default-credentials/). This is true to a lesser extent for the `.iso`'s also. All machines have several same settings by default like the same outdated SSH keys etcetera. A sword of Damocles ...

## Update and upgrade

Offensive Security make these files every few months or so. Kali is outdated (read "vulnerable") when it is installed. 

Update and upgrade immediately. And `apt dist-upgrade`.

    $ sudo apt update
    $ sudo apt upgrade
    $ sudo apt dist-upgrade

## New SSH keys

Everyone who downloaded and installed the same image have the same [SSH keys](../ssh.md). Create a new pair.

Create a folder `old_keys` in the `/etc/ssh` directory and move the old keys into that folder.

    $ sudo mkdir /etc/ssh/old_keys
    $ sudo mv ssh_host_* /etc/ssh/old_keys

Check with:

    $ ls /etc/ssh/old_keys

Create new pair:

    $ sudo dpkg-reconfigure openssh-server

Ignore warning message or a message about a static unit. 

Check the MD5 hashes of the new keys and compare them to the default ones moved into `old_keys`.

    $ md5sum /etc/ssh/ssh_host_*

and

    $ md5sum /etc/ssh/old_keys/ssh_host_*

If different, new SSH keys have been created.

## Firefox plugins

NoScript, Privacy badger, HTTPS everywhere, uBlock origin, user-agent switcher.